<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>New Project</title>
        
        <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.1.3/darkly/bootstrap.min.css">
        <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
        <script type="text/javascript" src="{{url_for('static', filename='scripts/dynamic-form.js')}}"></script>
    </head>
    <body>
        
        <div class="container">
            <h5>New Project</h5>
            <form method = "POST">
                <div class="form-group" id="dynamic_form">
                    <div class="row">
                        <div class="col-md-3">
                            <input type="text" name="p_name" id="p_name" placeholder="Project Name" class="form-control">
                        </div>
                        <div class="col-md-3">
                            <input type="text" name="p_name2" id="p_name2" placeholder="Project Name2" class="form-control">
                        </div>
                        <div class="col-md-3">
                            <input type="text" class="form-control" name="quantity" id="quantity" placeholder="Description">
                        </div>
                        <div class="col-md-4">
                            <textarea class="form-control" rows="1" name="remarks" placeholder="Remarks" id="remarks"></textarea>
                        </div>
                        <div class="button-group">
                            <a href="javascript:void(0)" class="btn btn-primary" id="plus5">Add KPI</a>
                            <a href="javascript:void(0)" class="btn btn-danger" id="minus5">Remove KPI</a>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
        
        <!-- Script-->
        <script>
            $(document).ready(function(){
                var dynamic_form = $("#dynamic_form").dynamicForm("#dynamic_form", "#plus5", "#minus5", {
                    limit: 10,
                    formPrefix: "dynamic_form",
                    normalizeFullForm : false
                });
                
                /** this will add the second row of inputs as a example.
                dynamic_form.inject([{p_name: 'Hemant',quantity: '123',remarks: 'testing remark'},{p_name: 'Harshal',quantity: '123',remarks: 'testing remark'}]);
                **/
                
                $("#dynamic_form #minus5").on('click', function(){
                    var initDynamicId = $(this).closest('#dynamic_form').parent().find("[id^='dynamic_form']").lenth;
                    if (initDynamicId === 2) {
                        $(this).closest('#dynamic_form').next().find('#minus5').hide()
                    }
                    $(this).closest("#dynamic_form").remove();
                });
                /**
                $('form').on('submit', function(event){
	        	var values = {};
				$.each($('form').serializeArray(), function(i, field) {
				    values[field.name] = field.value;
                });
                
				console.log(values)
        		event.preventDefault();
               })
               **/

               $('form').on('submit', function(event){
	        	var values = {};
				$.each($('form').serializeArray(), function(i, field) {
				    values[field.name] = field.value;
                });
                
                $.post("demo_test_post.asp",
                values,
                function(data,status){
                alert("Data: " + data + "\nStatus: " + status);
                })


				console.log(values)
               })

         
            });
        </script>        
    </body>
</html>